#!/bin/bash
# DB2 Setup Script

# Connect to database
db2 connect to BFBTEMPL

# Drop table if exists
db2 "DROP TABLE BANKS" || true

# Create the BANKS table
db2 "CREATE TABLE BANKS (
    ID VARCHAR(36) NOT NULL PRIMARY KEY,
    NAME VARCHAR(200) NOT NULL,
    BANK_CODE VARCHAR(20) NOT NULL UNIQUE,
    SWIFT_CODE VARCHAR(11),
    ADDRESS VARCHAR(500),
    PHONE_NUMBER VARCHAR(20),
    EMAIL VARCHAR(100),
    IS_ACTIVE SMALLINT NOT NULL DEFAULT 1,
    CREATED_AT TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    UPDATED_AT TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
)"

# Create indexes
db2 "CREATE INDEX IDX_BANKS_BANK_CODE ON BANKS(BANK_CODE)"
db2 "CREATE INDEX IDX_BANKS_SWIFT_CODE ON BANKS(SWIFT_CODE)"
db2 "CREATE INDEX IDX_BANKS_IS_ACTIVE ON BANKS(IS_ACTIVE)"

# Insert test data
db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440001', 'Deutsche Bank AG', 'DB001', 'DEUTDEFF', 'Taunusanlage 12, 60325 Frankfurt am Main, Germany', '+49-69-910-00', 'info@deutsche-bank.de', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440002', 'JPMorgan Chase Bank', 'JPM001', 'CHASUS33', '383 Madison Avenue, New York, NY 10017, USA', '+1-212-270-6000', 'customer.service@jpmorgan.com', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440003', 'HSBC Holdings plc', 'HSBC001', 'HBUKGB4B', '8 Canada Square, London E14 5HQ, United Kingdom', '+44-20-7991-8888', 'customer.services@hsbc.com', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440004', 'Bank of America Corp', 'BOA001', 'BOFAUS3N', '100 North Tryon Street, Charlotte, NC 28255, USA', '+1-704-386-5681', 'help@bankofamerica.com', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440005', 'Credit Agricole Group', 'CA001', 'AGRIFRPP', '12 Place des Etats-Unis, 92127 Montrouge, France', '+33-1-43-23-52-02', 'contact@credit-agricole.fr', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440006', 'Mitsubishi UFJ Financial Group', 'MUFG001', 'BOTKJPJT', '2-7-1 Marunouchi, Chiyoda-ku, Tokyo 100-8330, Japan', '+81-3-3240-1111', 'info@mufg.jp', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440007', 'Industrial and Commercial Bank of China', 'ICBC001', 'ICBKCNBJ', '55 Fuxingmennei Dajie, Xicheng District, Beijing 100140, China', '+86-10-6610-6114', 'service@icbc.com.cn', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440008', 'Wells Fargo & Company', 'WF001', 'WFBIUS6S', '420 Montgomery Street, San Francisco, CA 94104, USA', '+1-866-249-3302', 'customerservice@wellsfargo.com', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440009', 'Santander Group', 'SAN001', 'BSCHESMM', 'Ciudad Grupo Santander, 28660 Boadilla del Monte, Madrid, Spain', '+34-91-259-65-00', 'atencion.cliente@santander.es', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440010', 'Royal Bank of Canada', 'RBC001', 'ROYCCAT2', '200 Bay Street, Toronto, ON M5J 2J5, Canada', '+1-416-974-5151', 'client.care@rbc.com', 1)"

db2 "INSERT INTO BANKS (ID, NAME, BANK_CODE, SWIFT_CODE, ADDRESS, PHONE_NUMBER, EMAIL, IS_ACTIVE) VALUES 
('550e8400-e29b-41d4-a716-446655440011', 'Inactive Test Bank', 'INACTIVE001', 'TESTGB2L', '123 Inactive Street, London, United Kingdom', '+44-20-1234-5678', 'test@inactive-bank.com', 0)"

# Verify data
db2 "SELECT COUNT(*) AS TOTAL_BANKS FROM BANKS"
db2 "SELECT COUNT(*) AS ACTIVE_BANKS FROM BANKS WHERE IS_ACTIVE = 1"
db2 "SELECT COUNT(*) AS INACTIVE_BANKS FROM BANKS WHERE IS_ACTIVE = 0"
db2 "SELECT ID, NAME, BANK_CODE, SWIFT_CODE, IS_ACTIVE FROM BANKS ORDER BY NAME"

echo "Database setup complete!"
